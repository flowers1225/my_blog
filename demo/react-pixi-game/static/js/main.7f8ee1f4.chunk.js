(this["webpackJsonpreact-pixijs-game"]=this["webpackJsonpreact-pixijs-game"]||[]).push([[0],{55:function(t,e,n){},66:function(t,e,n){},70:function(t,e,n){"use strict";n.r(e);var c=n(4),r=n.n(c),a=n(34),u=n.n(a),i=(n(55),n(8)),o=n(9),s=n(20),j=(n(66),{count:0,isTouch:!1}),b=function(t,e){switch(e.type){case"UPDATE_COUNT":return Object.assign({},t,{count:t.count+1});case"UPDATE_TOUCH":return Object.assign({},t,{isTouch:!t.isTouch});default:return t}},O=Object(c.createContext)({}),f=n(11),d=function(t){var e=Object(c.useContext)(O),n=Object(o.a)(e,1)[0].count;return Object(f.jsx)(s.Text,{text:"\u9003\u8dd1\u4e86\uff1a".concat(n),style:{align:"center",fontWeight:900,dropShadow:!0,dropShadowAlpha:.6,dropShadowAngle:1,dropShadowBlur:5,wordWrap:!0,fill:["#ff0000"]},x:100,y:100})},l=n(7),h=n(49),x=n(50),p=function(t){var e=t.resource,n=t.speed,r=t.run,a=t.size,u=Object(c.useState)([]),j=Object(o.a)(u,2),b=j[0],d=j[1],l=Object(c.useRef)(null),p=Object(c.useState)({x:0,y:0}),g=Object(o.a)(p,2),m=g[0],y=g[1],w=Object(c.useRef)({x:0,y:0}),v=Object(c.useState)(!1),T=Object(o.a)(v,2),S=T[0],C=T[1],E=Object(c.useState)(!1),A=Object(o.a)(E,2),M=A[0],k=A[1],U=Object(c.useRef)({width:150,height:150}),F=Object(c.useContext)(O),P=Object(o.a)(F,2),D=P[0],R=P[1],z=D.isTouch,_=Object(c.useState)(!1),H=Object(o.a)(_,2),L=H[0],B=H[1],W=Object(c.useState)(!1),I=Object(o.a)(W,2),J=I[0],N=I[1],q=Object(c.useMemo)((function(){return[{x:a.width,y:a.height-180}]}),[a]),G=Object(o.a)(q,1)[0],K=Object(c.useMemo)((function(){return[{top:0,left:-U.current.width/2,right:a.width-U.current.width/2,bottom:G.y}]}),[a,G]),Q=Object(o.a)(K,1)[0],V=Object(x.useSpring)({},[]),X=Object(o.a)(V,2),Y=X[0],Z=X[1];Object(c.useEffect)((function(){d(e.run)}),[e]),Object(c.useEffect)((function(){y(Object(i.a)({},G))}),[G]),Object(c.useEffect)((function(){B(r),N(r)}),[r]),Object(s.useTick)((function(){if(m.x<=-U.current.width)return J&&N(!J),R({type:"UPDATE_COUNT"}),y((function(t){return{x:a.width,y:t.y}}));var t=Math.max(.1,n);return m.x<G.x/2&&J&&(t=1,B(!1)),y((function(e){return{x:e.x-10*t,y:e.y}}))}),!S);var $=Object(c.useCallback)((function(t){if(M||z)return!1;R({type:"UPDATE_TOUCH"}),!L&&J&&N(!1),k(!1),C(!0),w.current={x:t.data.global.x-m.x,y:t.data.global.y-m.y},d(e.catch),l.current.play()}),[m,M,e,l,R,z,L,J]),tt=Object(c.useCallback)((function(t){y({x:m.x,y:t}),k(!1),l.current.play()}),[m]),et=Object(c.useCallback)((function(t){if(!S||M)return!1;R({type:"UPDATE_TOUCH"}),C(!1);var n=G.y;if(d(e.run),l.current.stop(),n-m.y<100)return tt(n);Z.start({from:{y:m.y},to:{y:n},onRest:function(){tt(n)},onStart:function(){k(!0)}})}),[S,e,m,Z,G,M,tt,R]),nt=Object(c.useCallback)((function(t){if(S&&l.current){var e=Q.top,n=Q.left,c=Q.right,r=Q.bottom,a=Math.max(Math.min(c,t.data.global.x-w.current.x),n),u=Math.max(Math.min(r,t.data.global.y-w.current.y),e);y({x:a,y:u})}}),[S,Q]);return Object(f.jsx)(f.Fragment,{children:0!==b.length&&Object(f.jsx)(h.AnimatedSprite,Object(i.a)(Object(i.a)({ref:l},U.current),{},{alpha:S?.7:1,interactive:!0,textures:b,isPlaying:!0,initialFrame:0,animationSpeed:Math.max(Math.min(n,.45),.2),pointerdown:$,pointerup:et,pointerupoutside:et,pointermove:nt},M?Y:m))})},g=function(t){var e="".concat(".","/assets/sprite.json"),n=Object(s.useApp)(),r=Object(c.useRef)(!1),a=Object(c.useState)(null),u=Object(o.a)(a,2),j=u[0],b=u[1],O=new Array(8).fill({speed:.5});return Object(c.useEffect)((function(){r.current||(r.current=!0,n.loader.add(e).load((function(t,n){n[e].data.texture={};var c=n[e].data,r=c.animations,a=c.texture;Object.keys(r).map((function(t){return a[t]=[],r[t].map((function(e){return a[t].push(l.p.from(e))})),!1})),console.log(a),b(n[e].data.texture)})))}),[n.loader,e]),Object(f.jsx)(f.Fragment,{children:j&&Object(f.jsx)(s.Container,{children:O.map((function(e,n){var c=e.speed;return Object(f.jsx)(p,Object(i.a)({resource:j,speed:Math.random()*c,run:2===n},t),n)}))})})},m=function(){return{width:window.innerWidth,height:window.innerHeight}},y=function(t){var e=t.children,n=Object(c.useReducer)(b,j);return Object(f.jsx)(O.Provider,{value:n,children:e})},w=function(){var t=function(){var t=Object(c.useState)(m),e=Object(o.a)(t,2),n=e[0],r=e[1];return Object(c.useEffect)((function(){var t=function(){requestAnimationFrame((function(){r(m())}))};return window.addEventListener("resize",t),function(){window.removeEventListener("resize",t)}}),[]),n}(),e=Object(c.useCallback)((function(e){var n=t.height-50;e.clear(),e.lineStyle(2,0,1),e.moveTo(0,n),e.lineTo(t.width,n)}),[t]);return Object(f.jsx)(f.Fragment,{children:Object(f.jsx)(s.Stage,Object(i.a)(Object(i.a)({},m()),{},{options:{backgroundColor:16777215,resizeTo:window},children:Object(f.jsxs)(y,{children:[Object(f.jsx)(g,{size:t}),Object(f.jsx)(s.Graphics,{draw:e}),Object(f.jsx)(d,{})]})}))})},v=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,71)).then((function(e){var n=e.getCLS,c=e.getFID,r=e.getFCP,a=e.getLCP,u=e.getTTFB;n(t),c(t),r(t),a(t),u(t)}))};u.a.render(Object(f.jsx)(r.a.StrictMode,{children:Object(f.jsx)(w,{})}),document.getElementById("root")),v()}},[[70,1,2]]]);
//# sourceMappingURL=main.7f8ee1f4.chunk.js.map